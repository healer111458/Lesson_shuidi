# 《你不知道的javascript上》学习杂记
## 第一章
### 作用域与闭包
    1. 程序：var a = 2;
    1.1 编译原理
        编译的三大步骤：分词/词法分析、解析/语法分析、代码生成
        任何javas代码片段在执行前都要进行编译（通常就在执行前）。
    1.2 理解作用域
          1.2.1程序运行过程的组成：
            引擎、编译器、作用域
          1.2.2编译过程：
            编译器分解成词法单元 -> 树结构
            编译器询问作用域 “a” 是否存在 -> 生成代码
            引擎询问作用域新的 “a” 是否存在 -> 执行代码
        总结：
          变量的赋值操作会执行两个动作，首先编译器会在当前作用域中声明一个变量（如果之前没有声明过），然后在运行时引擎会在作用域中查找该变量，如果能够找到就会对它赋值。
          1.2.3引擎的查询方式：
            LHS 与 RHS 当变量出现在赋值操作的左侧时进行 LHS 查询，出现在右侧时进行 RHS 查询。
              eg:function foo(a) {
                  console.log( a ); 
                 }
                 foo( 2 );
                 最后一行 foo(..) 函数的调用需要对 foo 进行 RHS 引用，意味着“去找到 foo 的值，并把它给我”。代码中隐式的 a＝2 操作为了给参数 a（隐式地）分配值，需要进行一次 LHS 查询。。console. log(..) 本身也需要一个引用才能执行，因此会对 console 对象进行 RHS 查询，并且检查得到的值中是否有一个叫作 log 的方法。
          1.2.4测试题
            检验一下到目前的理解程度。把自己当作引擎，并同作用域进行一次“对话”：
            function foo(a) {
              var b = a;
              return a + b; 
            }
            var c = foo( 2 ); 
            1. 找到其中所有的 LHS 查询。（这里有 3 处！）
            2. 找到其中所有的 RHS 查询。（这里有 4 处！）
            解：
              1. （1）将 a 赋值给 b 时查询 b 是否存在与作用域中
                 （2）将 foo(2) 赋值给 c 时查询 c 是否存在与作用域中
                 （3）将 2 赋值给 a 查询 a 是否存在与作用域
              2. （1）return时发生LHS查询 return 是否存在
                 （2）调用foo()函数时发生LHS查询 foo() 是否存在
                 （3）对 b 赋值时 a 需要先进行LHS查询 a 是否存在
                 （4）对 c 赋值时 foo() 需要先进行LHS查询 foo() 是否存在
    1.3 作用域嵌套
        作用域是根据名称查找变量的一套规则。
        遍历嵌套作用域链的规则：
          引擎从当前的执行作用域开始查找变量，如果找不到， 就向上一级继续查找。当抵达最外层的全局作用域时，无论找到还是没找到，查找过程都 会停止。
    1.4 异常
        function foo(a) {
          console.log( a + b );
          b = a; 
        }
        foo( 2 );
        第一次对 b 进行 RHS 查询时是无法找到该变量的。
        如果 RHS 查询在所有嵌套的作用域中遍寻不到所需的变量，引擎就会抛出 ReferenceError 异常。
        当引擎执行 LHS 查询时，全局作用域中就会创建一个具有该名称的变量，并将其返还给引擎。(非严格模式下)
        如果 RHS 查询找到了一个变量，但是你尝试对这个变量的值进行不合理的操作， 比如试图对一个非函数类型的值进行函数调用，或着引用 null 或 undefined 类型的值中的属性，那么引擎会抛出另外一种类型的异常，叫作 TypeError。
        
        *ReferenceError 同作用域判别失败相关，而 TypeError 则代表作用域判别成功了，但是对结果的操作是非法或不合理的。

        ***作用域是一套规则，用于确定在何处以及如何查找变量（标识符）。如果查找的目的是对 变量进行赋值，那么就会使用 LHS 查询；如果目的是获取变量的值，就会使用 RHS 查询。